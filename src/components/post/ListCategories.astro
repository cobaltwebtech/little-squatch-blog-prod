---
import { getCategories } from "@/lib/post";
import { cn } from "@/lib/cn";
import { sluglify } from "@/lib/sluglify";
import { Button } from "@/components/starwind/button";

interface Props {
  activeCategory?: string;
}

const { activeCategory } = Astro.props;
const currentPath = Astro.url.pathname;
const categories = (await getCategories()) as string[];

// Add "View All" option to categories
const allCategories = ["View All", ...categories];
---

<section class="py-4 text-sm">
  <p class="mb-4 text-center text-xl font-semibold tracking-wide">
    Blog Categories
  </p>
  <div
    class="mx-auto flex w-full flex-wrap items-center justify-center gap-4 px-4 text-center text-xs sm:gap-6"
  >
    {
      allCategories.map((category: string) => {
        const sluglifiedCategory = sluglify(category.toLowerCase());
        const isActive =
          activeCategory?.toLowerCase() === sluglifiedCategory ||
          (currentPath === "/" && category === "View All");

        return (
          <Button
            href={
              category === "View All"
                ? "/"
                : `/category/${sluglifiedCategory}/1`
            }
            class={cn(
              "bg-muted-foreground hover:bg-muted-foreground/90 rounded-full px-4 py-2 font-light focus:outline-none",
              isActive &&
                "bg-primary hover:bg-primary/90 font-semibold focus:outline-none",
            )}
          >
            {category}
          </Button>
        );
      })
    }
  </div>
</section>
